datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id             String   @id @default(uuid())
  email          String   @unique
  password       String
  name           String?
  profilePhoto   String?
  cvSummaries    CVSummary[]
  jobOffers      JobOffer[]
  letters        GeneratedLetter[]
  subscription   Subscription?
  feedbacks      Feedback[]
  createdAt      DateTime @default(now())
}

model CVSummary {
  id       String   @id @default(uuid())
  content  String
  user     User     @relation(fields: [userId], references: [id])
  userId   String
  createdAt DateTime @default(now())
}

model JobOffer {
  id       String   @id @default(uuid())
  content  String
  user     User     @relation(fields: [userId], references: [id])
  userId   String
  createdAt DateTime @default(now())
}

model GeneratedLetter {
  id       String   @id @default(uuid())
  content  String
  language String
  user     User     @relation(fields: [userId], references: [id])
  userId   String

  createdAt DateTime @default(now())
}

model Subscription {
  id            String   @id @default(uuid())
  user          User     @relation(fields: [userId], references: [id])
  userId        String   @unique
  plan          String
  lettersQuota  Int
  lettersUsed   Int       @default(0)
  stripeSubId   String?
  renewedAt     DateTime?
}

model Feedback {
  id         String   @id @default(uuid())
  rating     Int
  comment    String?
  letter     GeneratedLetter @relation(fields: [letterId], references: [id])
  letterId   String
  user       User            @relation(fields: [userId], references: [id])
  userId     String
  createdAt  DateTime @default(now())
}
